#!/usr/bin/env php
<?php
require_once __DIR__."/../src/Core/cli.php";

$cmd = array_shift($argv);
array_unshift($argv,basename($cmd));

if ( count($argv) < 2 ) {
	echo "Usage: ".$cmd." file.php [directory]\n";
	echo "If directory is omitted, '.' is assumed\n\n";
	exit( -1 );
}

if ( count($argv) < 3 ) {
	array_push($argv,".");
}

echo "<?php\n";
echo "// Generated with \"".implode(' ',$argv)."\" -- DO NOT EDIT! //\n";

$files = array_diff(scandir($argv[2]),['.','..']);

foreach( $files as $file ) {
	$true_file = $argv[2].'/'.$file;
	if ( is_dir($true_file) ) {
		if ( file_exists($true_file.'/'.$argv[1]) ) {
			echo 'include __DIR__."/'.$argv[2].'/'.$argv[1]."\";\n";
		}
	}
}

exit(0);
